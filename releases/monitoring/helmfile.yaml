repositories:
  - name: prometheus-community
    url: https://prometheus-community.github.io/helm-charts
releases:
  - name: prometheus
    chart: prometheus-community/kube-prometheus-stack
    namespace: "{{ .Values.namespaces.monitoring }}"
    values:
      - values.yaml.gotmpl
    hooks:
      - events: ["prepare"]
        command: "sh"
        args: ["-c", "sops -d grafana-secret.enc.yaml | kubectl apply -n {{ .Values.namespaces.monitoring }} -f -"]
