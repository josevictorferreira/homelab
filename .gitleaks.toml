title = "Homelab Gitleaks Configuration"

[extend]
useDefault = true

[allowlist]
# Description of the allowlist
paths = [
  # Generated Kubernetes manifests - these are regenerated by make manifests
  # and use SOPS/vals for secret injection
  '''\.k8s\/.*\.yaml$''',
  '''\.k8s-manifests\/.*\.yaml$''',
  '''kubernetes\/manifests\/.*\.yaml$''',
  # SOPS encrypted files - these are safe
  '''\.enc\.yaml$''',
  '''\.enc\.nix$''',
  # Gitleaks results file
  '''results\.json$''',
  '''gitleaks-report\.json$''',
]

# Regex patterns for allowed secrets (false positives)
regexes = [
  # Placeholder/test secret that appears in multiple generated files
  # This is the sha256 hash of an empty string, used as a placeholder
  '''44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a''',
  # SOPS reference pattern - these are not actual secrets
  '''ref\+sops://''',
  # Base64 encoded SOPS references
  '''cG9zdGdyZXNxbDovL3Bvc3RncmVzOnJlZitzb3BzOi8v''',
]

# Stopwords - these indicate a likely false positive
stopwords = [
  # SOPS related
  "sops",
  "SOPS",
  "ref+sops",
  # Placeholder indicators
  "placeholder",
  "CHANGEME",
  "REPLACE_ME",
  # Test data indicators
  "test",
  "example",
  "sample",
  "checksum"
]
